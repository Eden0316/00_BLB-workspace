<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "mybatis-3-mapper.dtd" >
<mapper namespace="cartMapper">

	<resultMap id="cartResultSet" type="cart">
		<id column="CART_NO" property="cartNo" />
		<result column="MEMBER_ID" property="memberId" />
		<result column="PROD_NO" property="prodNo" />
		<result column="OPT_NO" property="optNo" />
		<result column="CART_QTY" property="cartQty" />
		
		<result column="PROD_NAME" property="prodName" />
		<result column="OPT_NAME" property="optName" />
		<result column="PROD_PRICE" property="prodPrice" />

	</resultMap>
	
	<!-- 장바구니 목록 조회 -->
	<select id="selectCartList"
			parameterType="string"
			resultMap="cartResultSet">
		SELECT C.CART_NO
			 , P.PROD_NO
		     , P.PROD_NAME
		     , O.OPT_NAME
		     , C.CART_QTY
		     , P.PROD_PRICE
		  FROM TB_CART C
		  LEFT JOIN TB_PRODUCT P ON (C.PROD_NO = P.PROD_NO)
		  LEFT JOIN TB_OPTION O USING(OPT_NO)
		 WHERE MEMBER_ID = #{memberId}
		 ORDER BY CART_NO DESC
	</select>
	
	<!-- 장바구니 X버튼으로 1개 상품만 삭제 -->
	<delete id="deleteCartOne"
			parameterType="_int">
		DELETE
		  FROM TB_CART
		 WHERE CART_NO = #{cartNo}
	</delete>
	
	<!-- 장바구니 체크박스 선택 삭제 -->
	<delete id="deleteCheckItems"
			parameterType="string">
		DELETE
		  FROM TB_CART
		 WHERE CART_NO IN (${cartNo})
	</delete>
	
	<!-- 장바구니 수량 변경 -->
	<update id="updateCartQuantity" parameterType="map">
	    UPDATE TB_CART
	    SET CART_QTY = #{updatedQty}
	    WHERE CART_NO = #{cartNo}
	</update>
	
	<!-- 장바구니 상품 선택 옵션 변경 -->
	<!-- 
	<update id="updateCartOption"
			parameterType="map">
		UPDATE TB_CART
		  SET OPT_NO = #{optNo}
		WHERE CART_NO = #{cartNo}
	</update>
	-->
	 
</mapper>